---
title: "Afeta o Gr√™mio?"
author: "Renan Tomazini"
date: "2022-10-06"
output: html_document
---
# Mas como isso afeta o Gr√™mio?

## Introdu√ß√£o

<img src="images\gremio-logo-escudo.png" alt="Escudo do Gr√™mio" style="width:200px; display: block;margin-left: auto;margin-right: auto;">

O Presente relat√≥rio busca responder uma pergunta que est√° sendo muito discutida na internet por pesquisadores do mundo inteiro, "Como isso afeta o Gr√™mio?"
A pergunta repercutiu em 2022, durante o Gre-Nal 435, quando o Internacional de Porto Alegre, o time Rival do Gr√™mio, declarou no Twitter: #INTxGRE | 2T | ‚è±Ô∏è 50' - AFETOU O GR√äMIO! üî•
Segundo o GloboEsporte, a frase tem origem em um v√≠deo produzido por um torcedor gremista que explicaria a rela√ß√£o da morte do pr√≠ncipe Phillip, marido da rainha Elizabeth II, do Reino Unido, em abril de 2021, com o clube. O v√≠deo se encontra dispon√≠vel no link: https://www.youtube.com/watch?v=d45kkL0EwSs

O meme se espalhou pela internet, chegando a ser usado por influencers em redes sociais e Streamings de Futebol na Twitch, ele tomou forma com o personagem Walter White de Breaking Bad, como na imagem abaixo:
<img src="images\walter.jpg" alt="drawing" style="width:200px; display: block;margin-left: auto;margin-right: auto;">


Desde ent√£o a pergunta que a internet faz √©: Como isso afeta o Gr√™mio?
Vou tentar ver algumas estat√≠sticas do clube, como Ranking e Pontos na CBF e no Brasileir√£o e tentar encontrar algumas rela√ß√µes com acontecimentos importantes do nosso cotidiano. Ent√£o esse √© o **Mas afeta o Gr√™mio?**

## Pacotes Requeridos:

```{r setup, include=FALSE}
#install.packages('plotly')
#install.packages('stringr')
#install.packages('tidyr')
library('plotly')
library('stringr')
library('tidyr')
```
Os pacotes a serem usados s√£o:
plotly
Para cria√ß√£o de gr√°ficos.

stringr
Para trabalhar com as strings presentes no dataset.

tidyr
Para auxiliar na limpeza e organiza√ß√£o das tabelas de dados.

## An√°lise {.tabset}

### Dados do Gr√™mio
Os primeiros dados referentes a Ranking CBF, Brasileir√£o e T√≠tulos foram retirados da Wikipedia e revisados no Globoesporte referente a cada ano.
J√° o pre√ßo do time foi pego do site transfermarkt. e est√° em Euro. 

```{r}
dadosGremio <- read.csv("data/estGremio.csv")
head(dadosGremio)
# Onde x √© o ano
```
Irei excluir 2010 e 2011 por n√£o termos os rankings da CBF.
```{r}
dadosGremio <- dadosGremio[3:13, ]
```

#### Vamos criar alguns gr√°ficos para ter uma no√ß√£o de cada ano

Pontos do Gr√™mio no Brasileir√£o
```{r}
fig <- plot_ly(dadosGremio, x = ~X, y = dadosGremio$PontosBr, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Pontos do Gr√™mio no Brasileir√£o",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Pontos"))
fig
```
Pontos do Gr√™mio Normalizados no Brasileir√£o
```{r}

score_p = scale(dadosGremio$PontosBr, center = T)
fig <- plot_ly(dadosGremio, x = ~X, y = score_p, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Pontos Normalizados do Gr√™mio no Brasileir√£o",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Tendencia"))
fig
```

Pontos do Gr√™mio no Ranking CBF
```{r}
fig <- plot_ly(dadosGremio, x = ~X, y = dadosGremio$PontosCBF, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Pontos do Gr√™mio no Ranking CBF",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Pontos"))
fig
```

Pontos do Gr√™mio Normalizados no Ranking CBF
```{r}

score_p = scale(dadosGremio$PontosCBF, center = T)
fig <- plot_ly(dadosGremio, x = ~X, y = score_p, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Pontos do Gr√™mio Normalizados Ranking CBF",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Tendencia"))
fig
```


Lugar do Gr√™mio no Ranking CBF
```{r}
fig <- plot_ly(dadosGremio, x = ~X, y = dadosGremio$RankingCBF, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Lugar do Gr√™mio no Ranking CBF",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Lugar"))
fig
```

Lugar do Gr√™mio Normalizados Ranking CBF
```{r}

score_p = scale(dadosGremio$RankingCBF, center = T)
fig <- plot_ly(dadosGremio, x = ~X, y = score_p, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Lugar do Gr√™mio Normalizados Ranking CBF",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Tendencia"))
fig
```

Titulos No Ano do Gr√™mio
```{r}

score_p = scale(dadosGremio$RankingCBF, center = T)
fig <- plot_ly(dadosGremio, x = ~X, y = dadosGremio$TitulosNoAno, name = 'trace 0', type = 'scatter', mode = 'lines') 

fig <- fig %>% layout(title = "Titulos do Gr√™mio no Brasileir√£o",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Titulos"))
fig
```

Coeficiente de Rela√ß√£o:
Usamos o "cor" em R, por padr√£o no metodo de Peterson. Ele vai nos retornar uma pontua√ß√£o sobre a correla√ß√£o entre os dois dados inseridos nele, por exemplo:
```{r}
score_pCBF = scale(dadosGremio$PontosCBF, center = T)
score_pBR = scale(dadosGremio$PontosBr, center = T)

print(cor(score_pCBF,score_pBR))

```
Como o esperado notamos que os Pontos da CBF e Pontos do Brasileir√£o tem uma rela√ß√£o baixa, praticamente Nula.

```{r}
score_pCBF = scale(dadosGremio$PontosCBF, center = T)
score_pBR = scale(dadosGremio$PontosBr, center = T)

fig <- plot_ly(dadosGremio, x = ~X, y = ~score_pCBF, name = 'Pontos CBF', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = ~score_pBR, name = 'Pontos Brasileir√£o', mode = 'lines+markers') 

fig <- fig %>% layout(title = "Rela√ß√£o normalizada Pontos CBF x Pontos Brasileir√£o",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Pontos"))

fig
```

Irei normalizar todos as variav√©is e usar a partir daqui para facilitar o trabalho:
```{r}
score_pCBF = scale(dadosGremio$PontosCBF, center = T)
score_pBR = scale(dadosGremio$PontosBr, center = T)
score_Tit = scale(dadosGremio$TitulosNoAno, center = T)
score_ValorDoTime = scale(dadosGremio$ValorDoTimeEuroMi, center = T)
print(cor(score_pCBF,score_pBR))

```

### O pre√ßo do time afeta?

Ser√° que o pre√ßo do elenco afeta o desempenho do time?
Primeiro a correla√ß√£o:
```{r}


sprintf("Pontos CBF e valor do time: %s",cor(score_pCBF,score_ValorDoTime))
sprintf("Pontos Brasileir√£o e valor do time: %s",cor(score_pBR,score_ValorDoTime))
sprintf("Titulos e valor do time: %s",cor(score_Tit,score_ValorDoTime))



```

Resultados interessantes, talvez o valor do time tenha rela√ß√£o com o n√∫mero de t√≠tulos
```{r}
score_pCBF = scale(dadosGremio$PontosCBF, center = T)
score_pBR = scale(dadosGremio$PontosBr, center = T)

fig <- plot_ly(dadosGremio, x = ~X, y = ~score_ValorDoTime, name = 'Valor do time', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = ~score_pBR, name = 'Pontos Brasileir√£o', mode = 'lines+markers') 

fig <- fig %>% add_trace(y = ~score_pCBF, name = 'Pontos CBF', mode = 'lines+markers') 

fig <- fig %>% add_trace(y = score_Tit, name = 'N√∫mero de t√≠tulos', mode = 'lines+markers') 

fig <- fig %>% layout(title = "Rela√ß√µes",

         xaxis = list(title = "Anos"),

         yaxis = list (title = "Pontos"))

fig
```

Como o esperado, h√° uma rela√ß√£o, ainda que n√£o t√£o forte, entre o pre√ßo do elenco do ano e o n√∫mero de titulos, como achamos com a correla√ß√£o de Pearson : 0.554542

Ou seja: **O pre√ßo do Elenco AFETA o Gr√™mio**


### Pol√≠tica

Ser√° que pol√≠tica Brasileira afeta o Gr√™mio? Vamos come√ßar com os filiados de alguns partidos desde 2012: PT, PSDB, PL, PCB e MDB, n√∫meros a partir de Janeiro retirados do: https://www.tse.jus.br/eleitor/estatisticas-de-eleitorado/filiados

```{r}
PTFilhados <- c(1523955,1550671,1588308,1586357,1589270,1585746,1585434,1589943,1475301,1544322,1607025)
PSDBFilhados <- c(1352831,1354704,1350434,1348537,1409120,1445992,1455773,1457534,1365550,1374981,1354405)
PCBFilhados <- c(15914,15579,15274,15138,14848,14824,14751,14680,12922,12784,12649)


```

Ser√° que h√° correla√ß√£o entre n√∫mero de filiados desses partidos e o desempenho do Gr√™mio?

#### PT
```{r}
PTFilhados <- scale(PTFilhados, center = T)
sprintf("Filiados do PT e sua rela√ß√£o com:")
sprintf("Pontos CBF %s",cor(score_pCBF,PTFilhados))
sprintf("Pontos Brasileir√£o %s",cor(score_pBR,PTFilhados))
sprintf("Titulos : %s",cor(score_Tit,PTFilhados))
sprintf("Valor do time: %s",cor(score_ValorDoTime,PTFilhados))



```
Aparentemente o numero de filiados do PT n√£o tem rela√ß√£o com o Gr√™mio, o mais perto seria o inverso com o valor do Elenco, por√©m n√£o chega a 50% de correla√ß√£o.

#### PSDB
```{r}
PSDBFilhados <- scale(PSDBFilhados, center = T)
sprintf("Filiados do PSDB e sua rela√ß√£o com:")
sprintf("Pontos CBF %s",cor(score_pCBF,PSDBFilhados))
sprintf("Pontos Brasileir√£o %s",cor(score_pBR,PSDBFilhados))
sprintf("Titulos : %s",cor(score_Tit,PSDBFilhados))
sprintf("Valor do time: %s",cor(score_ValorDoTime,PSDBFilhados))



```
Aparentemente o numero de filiados do PSDB tem uma estranha rela√ß√£o de 73% com o n√∫mero de titulos, vamos ver o gr√°fico normalizado:

```{r}
fig <- plot_ly(dadosGremio, x = ~X, y = score_Tit, name = 'Titulos do ano Normalizado', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = PSDBFilhados, name = 'Filiados PSDB normalizado', mode = 'lines+markers')

fig
```

#### PCB
```{r}
PCBFilhados <- scale(PCBFilhados, center = T)
sprintf("Filiados do PCB e sua rela√ß√£o com:")
sprintf("Pontos CBF %s",cor(score_pCBF,PCBFilhados))
sprintf("Pontos Brasileir√£o %s",cor(score_pBR,PCBFilhados))
sprintf("Titulos : %s",cor(score_Tit,PCBFilhados))
sprintf("Valor do time: %s",cor(score_ValorDoTime,PCBFilhados))



```
Aparentemente o numero de filiados do PCB n√£o tem rela√ß√£o com o Gr√™mio, o mais perto seria o inverso com o valor do Elenco assim como o PT, com um pouco mais de 50%, vamos plotar apenas para visualizar.

```{r}
fig <- plot_ly(dadosGremio, x = ~X, y = score_ValorDoTime, name = 'Valor do Time', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = PSDBFilhados, name = 'Filiados PCB normalizado', mode = 'lines+markers')

fig
```

Conclus√£o: Aparentemente o Gr√™mio n√£o √© afetado pelos 3 partidos. **N√£o afeta o Gr√™mio**

### Alguns dados da Economia afetam?

#### Rendimento real m√©dio mensal per capita nos domic√≠lios com televis√£o sem acesso a servi√ßo de televis√£o por assinatura em Reais
Vamos tentar alguns dados econ√¥micos, a come√ßar com Renda m√©dia Mensal, via "Rendimento real m√©dio mensal per capita nos domic√≠lios com televis√£o sem acesso a servi√ßo de televis√£o por assinatura em Reais" daqui: https://sidra.ibge.gov.br/tabela/7403

Infelizmente os dados tem que ser a partir de 2016
```{r}
rendaPerCapita <- c(976,1033,1065,1121,1121,1106)

dadosGremioRecorte2016 <- dadosGremio[5:10, ]


sprintf("Pontos CBF e Renda: %s",cor(dadosGremioRecorte2016$PontosCBF,rendaPerCapita))
sprintf("Pontos Brasileir√£o e Renda: %s",cor(dadosGremioRecorte2016$PontosBr,rendaPerCapita))
sprintf("Titulos e Renda: %s",cor(dadosGremioRecorte2016$TitulosNoAno,rendaPerCapita))
sprintf("Valor do time e Renda: %s",cor(dadosGremioRecorte2016$ValorDoTimeEuroMi,rendaPerCapita))



```
Interessante parece haver rela√ß√£o entre os pontos do Ranking da CBF e a Renda com 79%
Al√©m do valor do time com 73%, vamos plotar:

```{r}

 
fig <- plot_ly(dadosGremioRecorte2016, x = ~X, y = scale(rendaPerCapita, center = T), name = 'Renda per Capita', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = scale(dadosGremioRecorte2016$PontosCBF, center = T), name = 'Pontos CBF', mode = 'lines+')

fig <- fig %>% add_trace(y = scale(dadosGremioRecorte2016$ValorDoTimeEuroMi), name = 'Valor do Time', mode = 'lines')

fig
```

Fant√°stico, descobrimos que o Rendimento real m√©dio mensal per capita nos domic√≠lios com televis√£o sem acesso a servi√ßo de televis√£o por assinatura em Reais **afeta o Gr√™mio** desde 2016.


#### PIB per capita
https://sidra.ibge.gov.br/tabela/6784#/n1/all/v/9812/p/all/d/v9812%202/l/v,,t+p/resultado

Infelizmente os dados tem que ser a partir de 2016
```{r}
rendaPerCapita <- c(976,1033,1065,1121,1121,1106)

dadosGremioRecorte2016 <- dadosGremio[5:10, ]


sprintf("Pontos CBF e Renda: %s",cor(dadosGremioRecorte2016$PontosCBF,rendaPerCapita))
sprintf("Pontos Brasileir√£o e Renda: %s",cor(dadosGremioRecorte2016$PontosBr,rendaPerCapita))
sprintf("Titulos e Renda: %s",cor(dadosGremioRecorte2016$TitulosNoAno,rendaPerCapita))
sprintf("Valor do time e Renda: %s",cor(dadosGremioRecorte2016$ValorDoTimeEuroMi,rendaPerCapita))



```
Interessante parece haver rela√ß√£o entre os pontos do Ranking da CBF e a Renda com 79%
Al√©m do valor do time com 73%, vamos plotar:

```{r}

 
fig <- plot_ly(dadosGremioRecorte2016, x = ~X, y = scale(rendaPerCapita, center = T), name = 'Renda per Capita', type = 'scatter', mode = 'lines') 

fig <- fig %>% add_trace(y = scale(dadosGremioRecorte2016$PontosCBF, center = T), name = 'Pontos CBF', mode = 'lines+')

fig <- fig %>% add_trace(y = scale(dadosGremioRecorte2016$ValorDoTimeEuroMi), name = 'Valor do Time', mode = 'lines')

fig
```

Fant√°stico, descobrimos que o Rendimento real m√©dio mensal per capita nos domic√≠lios com televis√£o sem acesso a servi√ßo de televis√£o por assinatura em Reais **afeta o Gr√™mio** desde 2016.




